<div class='facets'>
<%  @sunspot_search_class.sunspot_all_filters.each do |f| %>
	<% unless f.facetable %>
		<% if params["#{f.name}_op"].present? %>
			<%= hidden_field_tag "#{f.name}_op", params["#{f.name}_op"], :id => nil %>
		<% end %>
		<% if params[f.name].present? %>
			<% if params[f.name].is_a?(Array) %>
				<% params[f.name].each do |value| %>
					<%= hidden_field_tag "#{f.name}[]", value, :id => nil %>
				<% end %>
			<% else %>

			<% end %>
		<% end %><%# if params[f.name].present? %>
	<% end %><%# unless f.facetable %>
<% end %><%#  @sunspot_search_class.sunspot_all_filters.each do |f| %>

	<% @search.facets.each do |facet| -%>
		<% next if facet.rows.empty? -%><%# don't show empty facets -%>
		<%= facet_for(facet,
			:multiselector => @sunspot_search_class.sunspot_columns.detect{|c|
					c.name == facet.name.to_s }.try(:multiple),
			:facet_counts  => true ) %>
		<%# 
			multiselector is for when a single subject could have many
			Either as an array in itself or perhaps some implementation
			of a has_many for enrollments or something
		%>
	<% end -%><%# @search.facets.each do |facet| -%>
	<%= render 'select_columns' %>
</div><!-- class='facets' -->
